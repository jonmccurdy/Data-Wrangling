library(DBI)
library(RSQLite)
con <- dbConnect(SQLite(), "college.db")
View(con)
set.seed(123)
# Names
first_names <- c("Alice","Ben","Claire","Danny","Evelyn","Frank","Grant",
"Hannah","Isabela","Jake","Kate","Liam","Mary","Nate",
"Olivia","Peter","Quinn","Rachel","Stacy","Thomas",
"Uma","Victor","Wendy","Xavier","Yara","Zach")
last_names <- c("Anderson","Brown","Clark","Davis","Evans","Foster","Green",
"Hughes","Ingram","Johnson","King","Lopez","Miller","Nelson",
"Owens","Parker","Quincy","Roberts","Stevens","Turner",
"Underwood","Vasquez","Williams","Xiong","Young","Zimmerman")
majors <- c("Data Science","Biology","History","Computer Science","Math",
"Psychology","Business","English")
years <- c("Freshman","Sophomore","Junior","Senior")
students <- data.frame(
student_id = 1:50,
name = paste(sample(first_names, 50, replace=TRUE),
sample(last_names, 50, replace=TRUE)),
major = sample(majors, 50, replace=TRUE),
gpa = round(runif(50, 2.5, 4.0), 2),
year = sample(years, 50, replace=TRUE)
)
courses <- data.frame(
course_id = 1:10,
course_name = c("Intro to R","Biology 101","World History",
"Algorithms","Calculus I","Psychology of Learning",
"Microeconomics","Literary Analysis","Statistics",
"Machine Learning"),
credits = sample(3:4, 10, replace=TRUE)
)
enrollments <- do.call(rbind, lapply(students$student_id, function(sid) {
n_courses <- sample(2:5, 1)
course_ids <- sample(courses$course_id, n_courses)
grades <- sample(c("A","A-","B+","B","B-","C+","C"), n_courses, replace=TRUE)
data.frame(student_id = sid, course_id = course_ids, grade = grades)
}))
?do.call
dbWriteTable(con, "Students", students, append=TRUE)
dbWriteTable(con, "Courses", courses, append=TRUE)
dbWriteTable(con, "Enrollments", enrollments, append=TRUE)
View(con)
dbListTables(con)
View(con)
dbListFields(con, "Courses")
dbListFields(con, "Courses")
dbListFields(con, "Enrollments")
dbListFields(con, "Students")
tbl(con, "Courses")
library(dbplyr)
library(dplyr)
tbl(con, "Courses")
tbl(con, "Students")
tbl(con, "Enrollments")
tbl(con, "Students")
collect(tbl(con, "Students"))
dbListFields(con, "Enrollments")
classes_per_student <- "SELECT course_id, COUNT(*)
FROM Enrollments
GROUP BY student_id"
dbGetQuery(con, classes_per_student)
classes_per_student <- "SELECT student_id, COUNT(course_id) AS num_courses
FROM Enrollments
GROUP BY student_id"
dbGetQuery(con, classes_per_student)
classes_per_student <- "SELECT student_id, COUNT(course_id)
FROM Enrollments
GROUP BY student_id"
dbGetQuery(con, classes_per_student)
tbl(con, "Enrollments")
tbl(con, "Enrollments") |>
group_by(student_id) |>
summarise(count = n())
tbl(con, "Enrollments") |>
group_by(student_id) |>
summarise(count = n()) |>
collect()
tbl(con, "Enrollments")
tbl(con, "Courses")
tbl(con, "Enrollments")
students_per_class <-   "SELECT course_id, COUNT(student_id)
FROM Enrollments
GROUP BY course_id"
dbGetQuery(con, students_per_class)
tbl(con, "Enrollments") |>
group_by(course_id) |>
summarise(count = n()) |>
collect()
tbl(con, "Students")
tbl(con, "Students")  %>% head()
students %>%
filter(year == "Junior") %>%
select(name, major, gpa)
students %>%
inner_join(enrollments, by = "student_id") %>%
inner_join(courses, by = "course_id") %>%
select(name, course_name, grade)
students %>%
inner_join(enrollments, by = "student_id")
getwd()
library(DBI)
library(RSQLite)
library(dplyr)
library(dbplyr)
dbGetQuery(con, "SELECT * FROM Students")
students %>% collect()
students <- tbl(con, "Students")
students %>% collect()
dbGetQuery(con, "SELECT * FROM Students")
con
dbGetQuery(con, "SELECT * FROM Students WHERE gpa > 3.5")
tbl(con, "Students") |> filter(gpa > 3.5)
dbListTables(db_con)
db_con <- dbConnect(SQLite(), "college.db")
dbListTables(db_con)
dbListFields(db_con, "Courses")
dbListFields(db_con, "Enrollments")
dbListFields(db_con, "Students")
tbl(db_con, "Courses")
tbl(db_con, "Enrollments")
tbl(db_con, "Students")
collect(tbl(db_con, "Students"))
dbGetQuery(db_con, "SELECT * FROM Students WHERE gpa > 3.5")
students |> filter(gpa > 3.5)
dbGetQuery(db_con, "SELECT * FROM Students ORDER BY gpa DESC")
students |> arrange(desc(gpa)) |> collect()
dbGetQuery(db_con, "SELECT * FROM Students WHERE gpa > 3.5")
tbl(db_con, "Students") |> filter(gpa > 3.5)
dbGetQuery(db_con, "
SELECT s.name, c.course_name, e.grade
FROM Students s
JOIN Enrollments e ON s.student_id = e.student_id
JOIN Courses c ON e.course_id = c.course_id
")
# dplyr
tbl(db_con, "Students") %>%
inner_join(tbl(db_con, "Enrollments"), by = "student_id") %>%
inner_join(tbl(db_con, "Courses"), by = "course_id") %>%
select(name, course_name, grade) %>%
collect()
getwd()
getwd()
dbDisconnect(con)
